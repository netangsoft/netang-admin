import{_ as e,M as a,p as o,q as c,R as t,t as n,N as s,a1 as p}from"./framework-204010b2.js";const r={},i=t("h1",{id:"power-权限",tabindex:"-1"},[t("a",{class:"header-anchor",href:"#power-权限","aria-hidden":"true"},"#"),n(" $power 权限")],-1),l={class:"custom-container tip"},u=t("p",{class:"custom-container-title"},"TIP",-1),k=t("code",null,"@netang/quasar/utils/$power.js",-1),v={href:"https://github.com/netangsoft/netang-quasar/blob/main/utils/%24power.js",target:"_blank",rel:"noopener noreferrer"},m={href:"https://gitee.com/jinmarcus/netang-quasar/blob/main/utils/%24power.js",target:"_blank",rel:"noopener noreferrer"},b=t("p",null,"权限工具",-1),h=p(`<h2 id="power-create" tabindex="-1"><a class="header-anchor" href="#power-create" aria-hidden="true">#</a> $power.create</h2><p>创建权限实例</p><ul><li>类型</li></ul><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>$power<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>options<span class="token operator">:</span> Object<span class="token punctuation">)</span><span class="token operator">:</span> Object
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="options-参数" tabindex="-1"><a class="header-anchor" href="#options-参数" aria-hidden="true">#</a> options 参数</h3><table><thead><tr><th>参数名</th><th>说明</th><th>类型</th><th>默认值</th><th>可选值</th><th>示例</th></tr></thead><tbody><tr><td>path</td><td>路由路径</td><td><code>String</code></td><td>-</td><td>-</td><td>-</td></tr><tr><td>query</td><td>路由参数</td><td><code>Object</code></td><td>-</td><td>-</td><td>-</td></tr><tr><td>pageLoading</td><td>是否加载页面</td><td><code>Boolean</code></td><td>false</td><td>-</td><td>-</td></tr><tr><td>pageStatus</td><td>页面状态</td><td><code>Boolean</code></td><td>null</td><td>-</td><td>-</td></tr><tr><td>emptyDescription</td><td>空状态描述</td><td><code>String</code></td><td>-</td><td>-</td><td>-</td></tr><tr><td>power</td><td>是否开启权限</td><td><code>Boolean</code></td><td>true</td><td>-</td><td>-</td></tr><tr><td>showPowerBtns</td><td>是否显示权限按钮</td><td><code>Boolean</code></td><td>true</td><td>-</td><td>-</td></tr><tr><td>showToolbarPowerBtns</td><td>是否显示工具栏权限按钮</td><td><code>Boolean</code></td><td>true</td><td>-</td><td>-</td></tr><tr><td><a href="#formatpowerbtns">formatPowerBtns</a></td><td>格式化权限按钮</td><td><code>Function</code></td><td>-</td><td>-</td><td>-</td></tr><tr><td>leftDrawerIcon</td><td>左边侧滑菜单图标</td><td><code>String</code></td><td>format_list_bulleted</td><td>-</td><td>-</td></tr><tr><td>rightDrawerIcon</td><td>右边侧滑菜单图标</td><td><code>search</code></td><td>-</td><td>-</td><td>-</td></tr><tr><td><a href="#requestbefore">requestBefore</a></td><td>请求前执行</td><td><code>Function</code></td><td>-</td><td>-</td><td>-</td></tr><tr><td><a href="#requestsuccess">requestSuccess</a></td><td>请求成功执行</td><td><code>Function</code></td><td>-</td><td>-</td><td>-</td></tr><tr><td><a href="#requestfail">requestFail</a></td><td>请求失败执行</td><td><code>Function</code></td><td>-</td><td>-</td><td>-</td></tr><tr><td><a href="#requestafter">requestAfter</a></td><td>请求后执行</td><td><code>Function</code></td><td>-</td><td>-</td><td>-</td></tr></tbody></table><h4 id="formatpowerbtns" tabindex="-1"><a class="header-anchor" href="#formatpowerbtns" aria-hidden="true">#</a> formatPowerBtns</h4><p>格式化权限按钮</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">// 创建权限实例</span>
<span class="token keyword">const</span> $power <span class="token operator">=</span> $n<span class="token punctuation">.</span>$power<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    
    <span class="token comment">// 格式化权限按钮</span>
    <span class="token function">formatPowerBtns</span><span class="token punctuation">(</span><span class="token parameter">item<span class="token punctuation">,</span> isFixed<span class="token punctuation">,</span> tableSelected</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        
        <span class="token comment">// 如果有选中数据</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>tableSelected<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            
            <span class="token comment">// 获取选中数据的第一条</span>
            <span class="token comment">// 类型</span>
            <span class="token keyword">const</span> <span class="token punctuation">{</span> type <span class="token punctuation">}</span> <span class="token operator">=</span> tableSelected<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
            
            <span class="token comment">// 如果按钮名称是订单详情</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>item<span class="token punctuation">.</span>title <span class="token operator">===</span> <span class="token string">&#39;订单详情&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                
                <span class="token comment">// 如果是商品订单</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>type <span class="token operator">===</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token comment">// 修改跳转页面地址</span>
                    item<span class="token punctuation">.</span>data<span class="token punctuation">.</span>toPage <span class="token operator">=</span> <span class="token string">&#39;/order/order/view&#39;</span>
                    <span class="token comment">// 修改按钮名称</span>
                    item<span class="token punctuation">.</span>title <span class="token operator">=</span> <span class="token string">&#39;订单详情&#39;</span>
                
                <span class="token comment">// 否则是退货订单</span>
                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                    <span class="token comment">// 修改跳转页面地址</span>
                    item<span class="token punctuation">.</span>data<span class="token punctuation">.</span>toPage <span class="token operator">=</span> <span class="token string">&#39;/order/refund/edit&#39;</span>
                    <span class="token comment">// 修改按钮名称</span>
                    item<span class="token punctuation">.</span>title <span class="token operator">=</span> <span class="token string">&#39;退货详情&#39;</span>
                <span class="token punctuation">}</span>
            
            <span class="token comment">// 如果按钮名称是订单包裹</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>item<span class="token punctuation">.</span>title <span class="token operator">===</span> <span class="token string">&#39;订单包裹&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                
                <span class="token comment">// 如果返回 false, 则该权限按钮不显示</span>
                <span class="token keyword">return</span> <span class="token boolean">false</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><table><thead><tr><th>参数名</th><th>说明</th><th>类型</th><th>示例</th></tr></thead><tbody><tr><td>powerBtn</td><td>单个权限按钮数据</td><td><code>Object</code></td><td>-</td></tr><tr><td>isFixed</td><td>是否固定在表格列中</td><td><code>Boolean</code></td><td>-</td></tr><tr><td>tableSelected</td><td>表格选中数据</td><td><code>Array</code></td><td>-</td></tr></tbody></table><h4 id="requestbefore" tabindex="-1"><a class="header-anchor" href="#requestbefore" aria-hidden="true">#</a> requestBefore</h4><p>请求前执行, 用于在请求前对数据进行一些验证或修改</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">// 创建权限实例</span>
<span class="token keyword">const</span> $power <span class="token operator">=</span> $n<span class="token punctuation">.</span>$power<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    
    <span class="token comment">// 请求前执行</span>
    <span class="token function">requestBefore</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> options<span class="token punctuation">,</span> requestData <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        
        <span class="token comment">// 如果没有标题</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>requestData<span class="token punctuation">.</span>title<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            
            <span class="token comment">// 轻提示</span>
            $n<span class="token punctuation">.</span><span class="token function">toast</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                <span class="token literal-property property">message</span><span class="token operator">:</span> <span class="token string">&#39;名称不能为空&#39;</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
            
            <span class="token comment">// 如果返回 false, 则取消该请求</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span>
        <span class="token punctuation">}</span>
        
        <span class="token comment">// 修改请求数据</span>
        requestData<span class="token punctuation">.</span>test_data <span class="token operator">=</span> <span class="token number">123</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><table><thead><tr><th>参数名</th><th>说明</th><th>类型</th><th>示例</th></tr></thead><tbody><tr><td>options</td><td>请求时的上下文参数</td><td><code>Object</code></td><td>-</td></tr><tr><td>requestData</td><td>请求接口的数据</td><td><code>Object</code></td><td>-</td></tr></tbody></table><h4 id="requestsuccess" tabindex="-1"><a class="header-anchor" href="#requestsuccess" aria-hidden="true">#</a> requestSuccess</h4><p>请求成功执行, 请求成功后进行一些操作</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">// 创建权限实例</span>
<span class="token keyword">const</span> $power <span class="token operator">=</span> $n<span class="token punctuation">.</span>$power<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    
    <span class="token comment">// 请求成功执行</span>
    <span class="token function">requestSuccess</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> options<span class="token punctuation">,</span> requestData<span class="token punctuation">,</span> next<span class="token punctuation">,</span> data<span class="token punctuation">,</span> response <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        
        <span class="token keyword">if</span> <span class="token punctuation">(</span>data<span class="token punctuation">.</span>type <span class="token operator">===</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            
            <span class="token comment">// 如果返回 false, 则不会继续向下执行</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span>
        <span class="token punctuation">}</span>
        
        <span class="token comment">// 确认框</span>
        $n<span class="token punctuation">.</span><span class="token function">confirm</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            <span class="token literal-property property">message</span><span class="token operator">:</span> <span class="token string">&#39;提交成功，确认继续执行吗？&#39;</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
            <span class="token comment">// 点击确认执行</span>
            <span class="token punctuation">.</span><span class="token function">onOk</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                
                <span class="token comment">// 如果传值为 false, 则关闭请求成功的轻提示</span>
                <span class="token function">next</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><table><thead><tr><th>参数名</th><th>说明</th><th>类型</th><th>示例</th></tr></thead><tbody><tr><td>options</td><td>请求时的上下文参数</td><td><code>Object</code></td><td>-</td></tr><tr><td>requestData</td><td>请求接口的数据</td><td><code>Object</code></td><td>-</td></tr><tr><td>next</td><td>继续向下执行</td><td><code>Function</code></td><td>-</td></tr><tr><td>status</td><td>请求结果状态</td><td><code>Boolean</code></td><td>-</td></tr><tr><td>data</td><td>请求返回数据</td><td><code>Any</code></td><td>-</td></tr><tr><td>response</td><td>请求返回原始数据</td><td><code>Object</code></td><td>-</td></tr></tbody></table><h4 id="requestfail" tabindex="-1"><a class="header-anchor" href="#requestfail" aria-hidden="true">#</a> requestFail</h4><p>请求失败执行</p><table><thead><tr><th>参数名</th><th>说明</th><th>类型</th><th>示例</th></tr></thead><tbody><tr><td>options</td><td>请求时的上下文参数</td><td><code>Object</code></td><td>-</td></tr><tr><td>requestData</td><td>请求接口的数据</td><td><code>Object</code></td><td>-</td></tr><tr><td>status</td><td>请求结果状态</td><td><code>Boolean</code></td><td>-</td></tr><tr><td>data</td><td>请求返回数据</td><td><code>Any</code></td><td>-</td></tr><tr><td>response</td><td>请求返回原始数据</td><td><code>Object</code></td><td>-</td></tr></tbody></table><h4 id="requestafter" tabindex="-1"><a class="header-anchor" href="#requestafter" aria-hidden="true">#</a> requestAfter</h4><p>请求后执行</p><table><thead><tr><th>参数名</th><th>说明</th><th>类型</th><th>示例</th></tr></thead><tbody><tr><td>options</td><td>请求时的上下文参数</td><td><code>Object</code></td><td>-</td></tr><tr><td>requestData</td><td>请求接口的数据</td><td><code>Object</code></td><td>-</td></tr><tr><td>status</td><td>请求结果状态</td><td><code>Boolean</code></td><td>-</td></tr><tr><td>data</td><td>请求返回数据</td><td><code>Any</code></td><td>-</td></tr><tr><td>response</td><td>请求返回原始数据</td><td><code>Object</code></td><td>-</td></tr></tbody></table><h3 id="返回数据" tabindex="-1"><a class="header-anchor" href="#返回数据" aria-hidden="true">#</a> 返回数据</h3><table><thead><tr><th>参数名</th><th>说明</th><th>类型</th><th>示例</th></tr></thead><tbody><tr><td>pageLoading</td><td>是否加载页面</td><td><code>ref(Boolean)</code></td><td>-</td></tr><tr><td>pageStatus</td><td>页面状态</td><td><code>ref(Boolean)</code></td><td>-</td></tr><tr><td>emptyDescription</td><td>空状态描述</td><td><code>ref(String)</code></td><td>-</td></tr><tr><td>routeFullPath</td><td>当前路由全路径</td><td><code>String</code></td><td>-</td></tr><tr><td>routePath</td><td>当前路由路径</td><td><code>String</code></td><td>-</td></tr><tr><td>routeQuery</td><td>当前路由参数</td><td><code>Object</code></td><td>-</td></tr><tr><td>getRoute</td><td>获取当前路由</td><td><code>Function</code></td><td>-</td></tr><tr><td>formatPowerBtns</td><td>格式化权限按钮</td><td><code>Function</code></td><td>-</td></tr><tr><td>leftDrawer</td><td>左边侧滑菜单数据</td><td><code>Object</code></td><td>-</td></tr><tr><td>rightDrawer</td><td>右边侧滑菜单数据</td><td><code>Object</code></td><td>-</td></tr><tr><td>tableSelected</td><td>表格已选数据</td><td><code>ref(Array)</code></td><td>-</td></tr><tr><td>uploader</td><td>上传器</td><td><code>Array</code></td><td>-</td></tr><tr><td>checkUploading</td><td>检查是否上传中</td><td><code>Function</code></td><td>-</td></tr><tr><td>powerPage</td><td>当前页面权限</td><td><code>Object</code></td><td>-</td></tr><tr><td>powerBtns</td><td>当前页面权限按钮</td><td><code>ref(Array)</code></td><td>-</td></tr><tr><td>toolbarPowerBtns</td><td>当前页面工具栏权限按钮</td><td><code>ref(Array)</code></td><td>-</td></tr><tr><td>powerBtnClick</td><td>权限按钮点击</td><td><code>Function</code></td><td>-</td></tr><tr><td>update</td><td>更新数据</td><td><code>Function</code></td><td>-</td></tr></tbody></table><h4 id="powerbtns" tabindex="-1"><a class="header-anchor" href="#powerbtns" aria-hidden="true">#</a> powerBtns</h4><p>单个权限按钮参数</p><table><thead><tr><th>参数名</th><th>说明</th><th>类型</th><th>可选值</th><th>示例</th></tr></thead><tbody><tr><td>id</td><td>按钮 ID</td><td><code>Number</code></td><td>-</td><td>-</td></tr><tr><td>pid</td><td>按钮上级 ID</td><td><code>Number</code></td><td>-</td><td>-</td></tr><tr><td>title</td><td>按钮名称</td><td><code>String</code></td><td>-</td><td>保存</td></tr><tr><td>url</td><td>按钮链接</td><td><code>String</code></td><td>-</td><td>/goods/goods/edit_save</td></tr><tr><td>name</td><td>按钮标识(取 url 最后一级，相当于 PHP 控制器中的方法名)</td><td><code>String</code></td><td>-</td><td>edit_save</td></tr><tr><td>type</td><td>按钮类型</td><td><code>Number</code></td><td><code>11</code> / <code>12</code> / <code>13</code> / <code>14</code> / <code>15</code> / <code>16</code> / <code>20</code></td><td>-</td></tr><tr><td>color</td><td>按钮颜色</td><td><code>String</code></td><td><code>default</code> / <code>primary</code> / <code>secondary</code> / <code>info</code> / <code>warning</code> / <code>negative</code></td><td>primary</td></tr><tr><td>icon</td><td>按钮图标</td><td><code>String</code></td><td>-</td><td>save</td></tr><tr><td>is_log</td><td>是否记录日志</td><td><code>Number</code></td><td><code>0</code> / <code>1</code></td><td>-</td></tr><tr><td>hidden</td><td>是否隐藏按钮</td><td><code>Boolean</code></td><td>-</td><td>-</td></tr><tr><td>data</td><td>按钮参数</td><td><code>Object</code></td><td>-</td><td>-</td></tr></tbody></table><p>data 按钮参数</p><table><thead><tr><th>参数名</th><th>说明</th><th>类型</th><th>可选值</th><th>默认值</th><th>示例</th></tr></thead><tbody><tr><td>selection</td><td>列表选择类型</td><td><code>String</code></td><td><code>none</code> / <code>single</code> / <code>multiple</code></td><td>single</td><td>-</td></tr><tr><td>show</td><td>显示类型</td><td><code>String</code></td><td><code>single</code> / <code>multiple</code> / <code>空(默认显示)</code></td><td>-</td><td>-</td></tr><tr><td>noFromPageQuery</td><td>禁止添加来源页面参数</td><td><code>Boolean</code></td><td>-</td><td>false</td><td>-</td></tr><tr><td>toPage</td><td>跳转页面 / 重定向 URL</td><td><code>String</code></td><td>-</td><td>-</td><td>-</td></tr><tr><td>fixed</td><td>是否固定列</td><td><code>Boolean</code></td><td>-</td><td>false</td><td>-</td></tr><tr><td>dbclick</td><td>是否双击</td><td><code>Boolean</code></td><td>-</td><td>false</td><td>-</td></tr><tr><td>confirm</td><td>是否确认（如果传字符串，则为确认提示的内容）</td><td><code>Boolean</code> / <code>String</code></td><td>-</td><td>false</td><td>-</td></tr><tr><td>confirmPassword</td><td>是否确认密码（如果传字符串，则为确认提示的内容）</td><td><code>Boolean</code> / <code>String</code></td><td>-</td><td>false</td><td>-</td></tr><tr><td>requestQuery</td><td>请求参数</td><td><code>Object</code></td><td>-</td><td>-</td><td>-</td></tr><tr><td>requestSuccess</td><td>请求成功执行</td><td><code>Object</code></td><td>-</td><td>-</td><td>-</td></tr><tr><td>params</td><td>自定义参数, 任意类型</td><td><code>Any</code></td><td>-</td><td>-</td><td>-</td></tr></tbody></table>`,31);function f(g,w){const d=a("ExternalLinkIcon");return o(),c("div",null,[i,t("div",l,[u,t("p",null,[k,n(),t("a",v,[n("Github"),s(d)]),n(),t("a",m,[n("Gitee"),s(d)])]),b]),h])}const j=e(r,[["render",f],["__file","power.html.vue"]]);export{j as default};
